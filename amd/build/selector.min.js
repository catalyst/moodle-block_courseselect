define(["core/ajax","core/modal_factory","core/modal_events","core/templates","core/config","core/str"],function(a,b,c,d,e,f){function g(a){window.location.href=e.wwwroot+"/course/view.php?id="+a}function h(){var e=b.create({type:b.types.SAVE_CANCEL});e.then(function(b){var e=f.get_string("confidencemodaltitle","block_courseselect").fail(Notification.exception);b.setTitle(e);var h=d.render("block_courseselect/confidence_modal",{});return b.setBody(h),b.getRoot().on(c.hidden,function(){b.destroy()}),b.getRoot().on(c.save,function(){var b=document.getElementById("block_courseselect-standard-select"),c=b.options[b.selectedIndex].value,d=document.querySelector('input[name="block_courseselect-confidence"]:checked').value;a.call([{methodname:"block_courseselect_set_confidence",args:{confidence:d,courseid:c}}],!0)[0].then(function(a){g(c)})}),b.show(),b}).fail(Notification.exception)}function i(b){a.call([{methodname:"block_courseselect_get_courses",args:{category:b}}],!0)[0].then(function(a){for(var b=document.getElementById("block_courseselect-standard-select"),c=b.options.length-1;c>=0;c--)b.remove(c);a.forEach(function(a){b.options[b.options.length]=new Option(a.fullname,a.id)}),b.selectedIndex===-1&&(document.getElementById("block_courseselect-complete-practice-assessment").disabled=!0),document.querySelectorAll(".block_courseselect-standard-column > div").forEach(function(a){a.style.display="block"})})}return{init:function(b){document.getElementById("block_courseselect-complete-practice-assessment").disabled=!0,document.getElementById("block_courseselect-subject-select").addEventListener("change",function(){a.call([{methodname:"block_courseselect_get_course_categories",args:{parent:this.value}}],!0)[0].then(function(a){for(var b=document.getElementById("block_courseselect-level-select"),c=b.options.length-1;c>=0;c--)b.remove(c);a.forEach(function(a){var c=!1;b.options[b.options.length]=new Option(a.name,a.id,c,c)}),document.querySelectorAll(".block_courseselect-level-column > label, .block_courseselect-level-column > select").forEach(function(a){a.style.display="block"}),document.querySelectorAll(".block_courseselect-standard-column > div").forEach(function(a){a.style.display="none"}),document.getElementById("block_courseselect-complete-practice-assessment").disabled=!0})}),document.getElementById("block_courseselect-level-select").addEventListener("change",function(){i(this.value)}),document.getElementById("block_courseselect-standard-select").addEventListener("change",function(){null!==this.value?document.getElementById("block_courseselect-complete-practice-assessment").disabled=!1:document.getElementById("block_courseselect-complete-practice-assessment").disabled=!0}),document.getElementById("block_courseselect-standard-search").addEventListener("keyup",function(a){for(var b=document.getElementById("block_courseselect-standard-select"),c=b.options.length-1;c>=0;c--)b.options[c].text.includes(a.target.value)?b.options[c].style.display="block":b.options[c].style.display="none"}),document.getElementById("block_courseselect-complete-practice-assessment").addEventListener("click",function(){var c=document.getElementById("block_courseselect-standard-select");if(c.selectedIndex!==-1){var d=c.options[c.selectedIndex].value;a.call([{methodname:"block_courseselect_is_confidence_set",args:{courseid:d}}],!0)[0].then(function(a){a.set===!0||0===b?g(d):h()})}})}}});